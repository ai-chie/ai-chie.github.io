{% include get_context_vars.html
     device=include.device
     lang=include.lang
     ui=include.ui
     warnings_data=include.warnings_data
     labels=include.labels
     schema=include.schema
     type=include.type
     posts=include.posts
%}

{%- for post in posts -%}
  {%- assign post_attrs = {} -%}
  {%- assign attr_list = "hidden,draft,featured,deprecated,beta,audience,private,admin_only,priority,color,icon,tooltip,created_timestamp,modified_timestamp" | split: "," -%}

  {%- for attr in attr_list -%}
    {%- assign value = post[attr] -%}
    {%- if value == nil -%}
      {%- assign value = schema[attr].default -%}
    {%- endif -%}
    {%- assign post_attrs = post_attrs | merge: {{ attr | jsonify }}: value -%}
  {%- endfor -%}

  {%- assign merged_item = post | merge: { "post_attrs": post_attrs } -%}
  {%- assign merged_items = merged_items | push: merged_item -%}
{%- endfor -%}
