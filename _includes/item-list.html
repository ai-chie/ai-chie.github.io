{% include get_context_vars.html
     device=include.device
     lang=include.lang
     ui=include.ui
     warnings_data=include.warnings_data
     labels=include.labels
     schema=include.schema
     type=include.type
     posts=include.posts
     merged_items=include.merged_items
     list_type=include.list_type
%}

{% assign list_type = include.list_type | default: 'post' %}

{% include item_data_preparer.html
  list_type=list_type
  posts=posts
  type=type
  lang=lang
  warnings_data=warnings_data
  schema=schema
%}

{% if list_type == 'taxonomy' and render_format == 'human' %}
{%- assign list_suffix = type | slugify -%}
<div class="mb-4">
  <input type="text" id="filter-{{ list_suffix }}" placeholder="{{ ui.search_placeholder[lang] }}" class="border px-2 py-1 mr-2">
  <select id="sort-{{ list_suffix }}" class="border px-2 py-1">
    <option value="count">{{ ui.sort_options.count[lang] }}</option>
    <option value="name">{{ ui.sort_options.name[lang] }}</option>
  </select>
</div>
{% endif %}

{% if list_type == 'taxonomy' %}
{%- assign list_suffix = type | slugify -%}
<section data-taxonomy-list="{{ list_suffix }}">
  {%- if render_format == 'human' -%}
    <h3 class="text-lg font-bold">{{ ui.title[type][lang] }}</h3>
    {%- if ui.description[type][lang] != blank -%}
      <p class="text-sm text-gray-500">{{ ui.description[type][lang] }}</p>
    {%- endif -%}
  {%- endif -%}

  {%- if merged_items.size == 0 -%}
    <p class="text-sm text-red-500 mt-4">{{ ui.empty_message[lang] }}</p>
  {%- endif -%}

  {%- if schema == nil or schema.size == 0 -%}
    <p class="text-red-600 font-bold">{{ ui.error_messages.schema_invalid[lang] }}</p>
  {%- endif -%}

  {% include item_list_generator.html
    merged_items=merged_items
    ui=ui
    labels=labels
    lang=lang
    schema=schema
    list_type=list_type
    base_path=base_path
  %}
</section>
{% else %}
<ul class="space-y-4">
  {% include item_list_generator.html
    merged_items=merged_items
    ui=ui
    labels=labels
    lang=lang
    schema=schema
    list_type=list_type
    base_path=base_path
  %}
</ul>
{% endif %}
